var Rum={};Rum.asyncParam="";Rum.validationTimeout=10;Rum.validationReady=true;Rum.init=function(b,a){Rum.asyncParam=b;Rum.validationTimeout=a};Rum.id=function(a){return document.getElementById(a)};Rum.flash=function(c,b){if(Rum.id("messages")){var a=document.createElement("li");a.setAttribute("class",b);a.innerHTML=c;Rum.id("messages").appendChild(a)}};Rum.forward=function(a){location.href=a};Rum.createXMLHttpRequest=function(){if(window.XMLHttpRequest){http_request=new XMLHttpRequest();if(http_request.overrideMimeType){http_request.overrideMimeType("text/html")}}else{if(window.ActiveXObject){try{http_request=new ActiveXObject("Msxml2.XMLHTTP")}catch(a){try{http_request=new ActiveXObject("Microsoft.XMLHTTP")}catch(a){}}}}if(!http_request){alert("Cannot create XMLHTTP instance");return false}return http_request};Rum.sendAsync=function(http_request,url,params,method,callback){if(method==null){method="GET"}if(params){params+="&"+Rum.asyncParam+"=1"}else{params="?"+Rum.asyncParam+"=1"}if(method.toUpperCase()=="GET"&&params){if(url.indexOf("?")>-1){url=url+"&"+params}else{url=url+"?"+params}params=""}if(callback!=null){eval("http_request.onreadystatechange="+callback)}http_request.open(method,url,true);http_request.setRequestHeader("Content-type","application/x-www-form-urlencoded");http_request.setRequestHeader("Content-length",params.length);http_request.setRequestHeader("Connection","close");http_request.send(params);return http_request};Rum.evalAsync=function(a,b,d){http_request=Rum.createXMLHttpRequest();var c=function(){Rum.evalHttpResponze(http_request)};Rum.sendAsync(http_request,a,b,d,c)};Rum.getHttpResponse=function(a){if(a){if(a.readyState==4){if(a.status==200){response=a.responseText;return response}else{throw"Problem retrieving XML data"}}}};Rum.evalHttpResponze=function(http_request){eval(Rum.getHttpResponse(http_request))};Rum.sendSync=function(d,e,f){if(f==null){f="GET"}if(e==null){e=""}if(f.toUpperCase()=="GET"&&e){if(d.indexOf("?")>-1){d=d+"&"+e}else{d=d+"?"+e}e="";location.href=d}else{e=e.split("&");var c=document.createElement("form");c.action=d+"/";c.method="POST";c.style.display="none";for(var a=0;a<e.length;a++){param=e[a].split("=");var b=document.createElement("input");b.setAttribute("name",param[0]);b.setAttribute("value",param[1]);c.appendChild(b)}document.body.appendChild(c);c.submit()}};Rum.submit=function(a,b){Rum.createFrame(a,b);return true};Rum.evalFormResponse=function(form,response){eval(response);form.removeChild(document.getElementById(form.getAttribute("id")+"__async"));form.setAttribute("target","")};Rum.createFrame=function(d,g){var b="f"+Math.floor(Math.random()*99999);var a=document.createElement("DIV");var f=document.getElementById(d.getAttribute("id")+"__async_postback");if(f){f.parentNode.removeChild(f)}a.id=d.getAttribute("id")+"__async_postback";a.innerHTML='<iframe style="display:none" src="about:blank" id="'+b+'" name="'+b+'" onload="Rum.documentLoaded(Rum.id(\''+d.getAttribute("id")+"'), '"+b+"'); return true;\"></iframe>";document.body.appendChild(a);var e=document.getElementById(b);if(g&&typeof(g)=="function"){e.completeCallback=g}var c=document.createElement("input");c.setAttribute("type","hidden");c.setAttribute("name",Rum.asyncParam);c.setAttribute("value","1");c.setAttribute("id",d.getAttribute("id")+"__async");d.appendChild(c);d.setAttribute("target",b)};Rum.documentLoaded=function(a,d){var c=document.getElementById(d);var b=null;if(c.contentDocument){b=c.contentDocument}else{if(c.contentWindow){b=c.contentWindow.document}else{b=window.frames[d].document}}if(b.location.href=="about:blank"){return}if(typeof(c.completeCallback)=="function"){c.completeCallback(a,b.body.textContent)}};Rum.assert=function(b,a){Rum.setText(Rum.id(b),a);Rum.reset()};Rum.clear=function(a){if(Rum.id(a)){Rum.id(a).style.display="none";this.className=this.className.replace("invalid","")}Rum.reset()};Rum.reset=function(){Rum.validationReady=false;window.setTimeout("Rum.setValidationReady()",Rum.validationTimeout)};Rum.setValidationReady=function(){Rum.validationReady=true};Rum.isReady=function(a){if(Rum.hasText(Rum.id(a))){return Rum.validationReady}return false};Rum.setText=function(b,d,a){if(b){if(b.hasChildNodes()){while(b.childNodes.length>=1){b.removeChild(b.firstChild)}}var c=document.createElement("span");if(d.length>0){c.appendChild(document.createTextNode(d));b.style.display="block"}else{c.appendChild(document.createTextNode(""));b.style.display="none"}b.appendChild(c)}};Rum.hasText=function(a){if(a){if(a.hasChildNodes()){if(a.childNodes.length>=1){if(a.childNodes[0].textContent.length>0){return true}}}}return null};