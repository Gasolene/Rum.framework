var Rum={};Rum.objs=Array();Rum.asyncParam="";Rum.validationReady=true;Rum.id=function(a){return document.getElementById(a)};Rum.createXMLHttpRequest=function(){if(window.XMLHttpRequest){http_request=new XMLHttpRequest();if(http_request.overrideMimeType){http_request.overrideMimeType("text/html")}}else{if(window.ActiveXObject){try{http_request=new ActiveXObject("Msxml2.XMLHTTP")}catch(a){try{http_request=new ActiveXObject("Microsoft.XMLHTTP")}catch(a){}}}}if(!http_request){alert("Cannot create XMLHTTP instance");return false}return http_request};Rum.sendAsync=function(url,params,method,callback){if(method==null){method="GET"}if(params){params+="&"+Rum.asyncParam+"=1"}else{params="?"+Rum.asyncParam+"=1"}if(method.toUpperCase()=="GET"&&params){if(url.indexOf("?")>-1){url=url+"&"+params}else{url=url+"?"+params}params=""}http_request=Rum.createXMLHttpRequest();if(callback!=null){eval("http_request.onreadystatechange="+callback)}http_request.open(method,url,true);http_request.setRequestHeader("Content-type","application/x-www-form-urlencoded");http_request.setRequestHeader("Content-length",params.length);http_request.setRequestHeader("Connection","close");http_request.send(params);return http_request};Rum.sendSync=function(d,e,f){if(f==null){f="GET"}if(e==null){e=""}if(f.toUpperCase()=="GET"&&e){if(d.indexOf("?")>-1){d=d+"&"+e}else{d=d+"?"+e}e="";location.href=d}else{e=e.split("&");var c=document.createElement("form");c.action=d+"/";c.method="POST";c.style.display="none";for(var a=0;a<e.length;a++){param=e[a].split("=");var b=document.createElement("input");b.setAttribute("name",param[0]);b.setAttribute("value",param[1]);c.appendChild(b)}document.body.appendChild(c);c.submit()}};Rum.getHttpResponse=function(http_request_var){eval("var http_request = "+http_request_var);if(http_request){if(http_request.readyState==4){if(http_request.status==200){response=http_request.responseText;eval(http_request_var+" = null");return response}else{throw"Problem retrieving XML data"}}}};Rum.eval=function(http_request_var){eval(Rum.getHttpResponse(http_request_var))};Rum.setOpacity=function(a,b){document.getElementById(a).style.opacity=b;document.getElementById(a).style.MozOpacity=b;document.getElementById(a).style.KhtmlOpacity=b;document.getElementById(a).style.filter="alpha(opacity="+(b*100)+");";if(b<0.1){document.getElementById(a).style.display="none"}else{document.getElementById(a).style.display="block"}};Rum.fadeIn=function(a,b){if(!b){b=1000}for(i=0;i<=1;i+=(1/20)){setTimeout("Rum.setOpacity('"+a.id+"',"+i+")",i*b)}};Rum.fadeOut=function(a,b){if(a.style.display!="none"){if(!b){b=1000}for(i=0;i<=1;i+=(1/20)){setTimeout("Rum.setOpacity('"+a.id+"',"+(1-i)+")",i*b)}}};Rum.submit=function(a,b){Rum.createFrame(a,b);return true};Rum.createFrame=function(d,g){var b="f"+Math.floor(Math.random()*99999);var a=document.createElement("DIV");var f=document.getElementById(d.getAttribute("id")+"__async_postback");if(f){f.parentNode.removeChild(f)}a.id=d.getAttribute("id")+"__async_postback";a.innerHTML='<iframe style="display:none" src="about:blank" id="'+b+'" name="'+b+'" onload="Rum.documentLoaded(document.getElementById(\''+d.getAttribute("id")+"'), '"+b+"'); return true;\"></iframe>";document.body.appendChild(a);var e=document.getElementById(b);if(g&&typeof(g)=="function"){e.completeCallback=g}var c=document.createElement("input");c.setAttribute("type","hidden");c.setAttribute("name",Rum.asyncParam);c.setAttribute("value","1");c.setAttribute("id",d.getAttribute("id")+"__async");d.appendChild(c);d.setAttribute("target",b)};Rum.documentLoaded=function(a,d){var c=document.getElementById(d);var b=null;if(c.contentDocument){b=c.contentDocument}else{if(c.contentWindow){b=c.contentWindow.document}else{b=window.frames[d].document}}if(b.location.href=="about:blank"){return}if(typeof(c.completeCallback)=="function"){c.completeCallback(a,b.body.textContent)}};Rum.setErrMsg=function(b,a){Rum.setText(Rum.id(b),a)};Rum.clrErrMsg=function(a){if(Rum.id(a)){Rum.id(a).style.display="none";this.className=this.className.replace("invalid","")}};Rum.setText=function(b,d,a){if(b){if(b.hasChildNodes()){while(b.childNodes.length>=1){b.removeChild(b.firstChild)}}var c=document.createElement("span");if(d.length>0){c.appendChild(document.createTextNode(d));b.style.display="block"}else{c.appendChild(document.createTextNode(""));b.style.display="none"}b.appendChild(c)}};Rum.hasText=function(a){if(a){if(a.hasChildNodes()){if(a.childNodes.length>=1){if(a.childNodes[0].textContent.length>0){return true}}}}return null};Rum.resetValidationTimer=function(a){Rum.validationReady=false;window.setTimeout("Rum.setValidationReady()",a)};Rum.isValidationReady=function(){return Rum.validationReady};Rum.setValidationReady=function(){Rum.validationReady=true};Rum.evalFormResponse=function(form,response){eval(response);form.removeChild(document.getElementById(form.getAttribute("id")+"__async"));form.setAttribute("target","")};